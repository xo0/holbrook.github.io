* 项目简介

所谓“直联”，是指将公司的债券业务系统通过系统间接口，与中债登的综合业务系统进行连接。

实现直联后，前台交易指令与后台结算指令可以自动匹配（目前需要人工核对），从而提高效率，降低人为失误造成的风险；同时，前台、中台人员也可以及时获得后台结算的相关状态和数据，而不需要通过电话、邮件等方式询问。

要实现直联，需要部署直联接口机，并对现有的债券业务系统进行改造。
* 项目范围

下图为债券业务系统的逻辑架构，其中红色（结算服务系统、直联接口机）为本项目新建内容；黄色（债券系统）为本项目改造内容。其余部分（绿色）为现有内容。

[[../../../1.域/bondTrade/images/logic.jpg]]

如图所示，本项目需要增加中债登直联接口机、结算服务系统，并对现有的债券系统进行改造。

* 项目要点
直联项目主要涉及直联接口服务的搭建、债券业务系统的改造、全面系统的测试。

业务测试是本项目的重点。需要覆盖各种业务类型和场景，以及各种异常情况的测试。中债登会参与系统的测试和验收，以决定是否准入。

整个项目的周期会在7-8个月。

* 初步计划

** 项目准备

主要是人员方面的准备，需要牵头部门协调前（中）后台的接口人，尤其是前台和后台业务人员一定要参与。

要与开发商确定整体的范围、计划、系统规划设计等内容。

** 基础设施

基础设施建设主要由信息技术中心负责。包括以下内容：

*** 机架准备

本系统属于业务支撑系统，为了保证较高的运维等级，会逐步迁移到军博机房。

本项目新建的直联接口机和结算服务系统直接部署在军博机房，其他部分逐步迁移过去。

*** 网络
1. 申请到中债登的专线
   
   这项工作之前已经开展。现在的新需求是先建设一条中债登到军博机房的SDH专线，原有中债登到总部的DDN专线暂时保留。

   到本项目上线后，将中债登到总部的专线替换成SDH。

2. IP划分和防火墙设置
   
   为直联接口机和结算服务系统分配IP。

   直联接口机和结算服务系统之间需要http通信。

   结算服务系统需要和债券系统的Oracle（TCP/1521)及MQ（TCP/1414)通信。目前Oracle和MQ均位于50.2.61.11。

*** 直联接口机部署和调试(预计2周）

- linux+websphere6.1+中债登提供的war
- 以及基本的配置
- 使用客户端代码进行初步的联通测试

** 应用系统建设（预计5个月）

应用系统建设主要由开发商负责。包括部署新的结算服务系统，以及对现有债券系统的改造。

*** 结算服务系统（预计1个月）
- 部署
- 与直联接口机联调

*** 债券系统（预计5个月）
**** 需求（1.5月）

熟悉报文标准

确认业务种类，结算方式，业务过程（场内、场外）

内部系统逻辑分析，业务各环节中需要与中债登进行的数据交互，超时的处理逻辑，场内场外交易匹配的逻辑等

**** 设计（1.5月）
主要是债券业务系统的设计，包括流程、界面、接口方式等

因并发数的限制，要在减少交互方面精细设计，比如利用批量查询获取状态，根据指令/合同状态决定是否进一步获取明细数据

**** 开发（1.5月）
具体周期需要与开发商协商。

**** 集成测试（0.5月）
债券系统与结算服务系统联调测试

** 业务测试及验收

业务测试需要业务部门牵头，开发商和信息技术中心配合，联合中债登、交易对手共同进行。

测试范围：
- 业务种类： 分销、现券买卖、质押式回购、买断式回购、远期交易、债券借贷
- 结算方式： DVP、PAD、DAP、FOP
- 业务过程： 整个业务过程包括指令录入、本方确认、对手方确认、覆盖各种指令状态及合同状态，场内/场外交易过程
- 业务场景： 覆盖各种正常和异常情况，如撤单、非法指令、超时、网络故障等场景

尤其是对于超时的处理，对于发送指令超时的情况，需要先冻结，再查询确认，最后决定重发或重置状态

测试要分成以下几个阶段进行。

*** 内部测试(2个月)
**** 接口测试（1个月）
**** 应用系统测试（1个月）
可以与应用系统改造过程部分并行

*** 联通测试(1周）

只进行联通性测试和基本业务功能的测试。

需要先设计业务案例

需要中债登的配合

*** 联合测试(2个月)

与中债登及对手机构联合测试

需要双方或三方配合

*** 中债登验收（2周)

需要提交上线申请，请中债登现场验收

** 试运行（预计3个月）

应用系统需要能够在手工结算/直联结算两种方式之间随时切换

开始的两个月，需要在中债登客户端上人工复核

** 正式上线

--------


